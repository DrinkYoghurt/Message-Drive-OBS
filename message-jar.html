<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OBS Message Drive</title>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Courier New', monospace;
    }
    
    /* Custom scrollbar */
    .custom-scrollbar {
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    
    .custom-scrollbar::-webkit-scrollbar {
      display: none;
    }
    
    @keyframes scanline {
      0% { transform: translateY(-100%); }
      100% { transform: translateY(100%); }
    }
    
    @keyframes glitch {
      0%, 100% { transform: translate(0); }
      33% { transform: translate(-2px, 2px); }
      66% { transform: translate(2px, -2px); }
    }
    
    @keyframes eject {
      0% { transform: translateX(0) scale(0.8); opacity: 0; }
      50% { transform: translateX(150px) scale(1); opacity: 1; }
      100% { transform: translateX(300px) scale(1); opacity: 1; }
    }
    
    .scanline {
      animation: scanline 8s linear infinite;
    }
    
    .glitch-text {
      animation: glitch 0.3s infinite;
    }
    
    .eject-animation {
      animation: eject 0.6s ease-out forwards;
    }
    
    .corner-cut {
      clip-path: polygon(20px 0%, 100% 0%, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0% 100%, 0% 20px);
    }
    
    .tech-border {
      background: linear-gradient(45deg, #00ff00 0%, #00ff00 50%, transparent 50%, transparent 100%);
      background-size: 10px 10px;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function MessageDrive() {
      const [messages, setMessages] = useState([]);
      const [availableMessages, setAvailableMessages] = useState([]);
      const [currentMessage, setCurrentMessage] = useState(null);
      const [ejecting, setEjecting] = useState(false);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);

      useEffect(() => {
        loadMessages();
      }, []);

      const loadMessages = async () => {
        try {
          const response = await fetch('messages.json');
          
          if (!response.ok) {
            throw new Error('Could not load messages.json');
          }
          
          const data = await response.json();
          const loadedMessages = data.messages || data;
          setMessages(loadedMessages);
          setAvailableMessages([...loadedMessages]);
          setLoading(false);
        } catch (err) {
          console.error('Error loading messages:', err);
          setError(err.message);
          
          const fallbackMessages = [
            { id: 1, text: "SYSTEM.MSG: You're awesome!", author: 'User_001' },
            { id: 2, text: "DATA.LOG: Keep up the great work!", author: 'User_002' },
            { id: 3, text: "INFO.TXT: Thanks for streaming!", author: 'User_003' },
            { id: 4, text: "NOTE.DAT: Love your content!", author: 'User_004' },
            { id: 5, text: "MSG.SYS: You make my day!", author: 'User_005' }
          ];
          setMessages(fallbackMessages);
          setAvailableMessages([...fallbackMessages]);
          setLoading(false);
        }
      };

      const ejectMessage = () => {
        if (availableMessages.length === 0 || ejecting) {
          // Reset als alle messages zijn laten zien
          if (availableMessages.length === 0 && messages.length > 0) {
            setAvailableMessages([...messages]);
          }
          return;
        }
        
        setEjecting(true);
        const randomIndex = Math.floor(Math.random() * availableMessages.length);
        const selected = availableMessages[randomIndex];
        
        // Haalt de message weg van de pool
        const newAvailable = availableMessages.filter((_, index) => index !== randomIndex);
        setAvailableMessages(newAvailable);
        
        setTimeout(() => {
          setCurrentMessage(selected);
        }, 300);
        
        setTimeout(() => {
          setEjecting(false);
        }, 600);
      };

      const closeMessage = () => {
        setCurrentMessage(null);
      };

      if (loading) {
        return (
          <div className="w-full h-screen bg-transparent flex items-center justify-center">
            <div className="text-2xl font-bold text-green-500 animate-pulse">
              [LOADING DATA...]
            </div>
          </div>
        );
      }

      return (
        <div className="w-full h-screen bg-transparent relative">
          {/* Harde Schijf - Links Onderin */}
          <div className="absolute bottom-8 left-8">
            {/* Main Schijf Body */}
            <div className="relative">
              {/* Schijf vak */}
              <div className="relative w-80 h-72 bg-gradient-to-br from-gray-900 via-black to-gray-800 rounded-lg border-2 border-green-500 shadow-2xl overflow-hidden"
                   style={{boxShadow: '0 0 20px rgba(0, 255, 0, 0.3), inset 0 0 20px rgba(0, 255, 0, 0.1)'}}>
                
                {/* Scanline effect */}
                <div className="absolute inset-0 pointer-events-none">
                  <div className="scanline w-full h-8 bg-gradient-to-b from-transparent via-green-500/20 to-transparent"></div>
                </div>
                
                {/* Hoeken */}
                <div className="absolute top-0 left-0 w-8 h-8 border-l-2 border-t-2 border-green-400"></div>
                <div className="absolute top-0 right-0 w-8 h-8 border-r-2 border-t-2 border-green-400"></div>
                <div className="absolute bottom-0 left-0 w-8 h-8 border-l-2 border-b-2 border-green-400"></div>
                <div className="absolute bottom-0 right-0 w-8 h-8 border-r-2 border-b-2 border-green-400"></div>
                
                {/* Schijf Header */}
                <div className="absolute top-4 left-4 right-4">
                  <div className="bg-black/80 border border-green-500 px-3 py-2 rounded">
                    <div className="text-green-400 text-xs font-mono tracking-wider">
                      ╔═══════════════════════════════╗
                    </div>
                    <div className="text-green-400 text-base font-bold font-mono text-center">
                      MESSAGE.DRIVE
                    </div>
                    <div className="text-green-400 text-xs font-mono tracking-wider">
                      ╚═══════════════════════════════╝
                    </div>
                  </div>
                </div>
                
                {/* Status Display */}
                <div className="absolute top-28 left-4 right-4">
                  <div className="bg-black/60 border border-green-500/50 px-4 py-4 rounded font-mono text-base">
                    <div className="text-green-400 mb-2">
                      <span className="text-green-300">STATUS:</span> ONLINE
                    </div>
                    <div className="text-green-400 mb-2">
                      <span className="text-green-300">FILES:</span> {availableMessages.length}/{messages.length} MSG
                    </div>
                    <div className="text-green-400 mb-2">
                      <span className="text-green-300">SPACE:</span> {(messages.length * 0.5).toFixed(1)}KB
                    </div>
                  </div>
                </div>
                
                {/* Schijf Slot met ejecting Kaart */}
                <div className="absolute bottom-10 left-4 right-4 h-12 bg-black border-2 border-green-500/70 rounded overflow-hidden">
                  <div className="absolute inset-0 flex items-center justify-center">
                    {ejecting && (
                      <div className="eject-animation absolute left-2 bg-gradient-to-r from-green-400 to-green-600 text-black px-4 py-2 rounded text-xs font-bold"
                           style={{boxShadow: '0 0 15px rgba(0, 255, 0, 0.8)'}}>
                        EJECTING...
                      </div>
                    )}
                    {!ejecting && (
                      <div className="text-green-500/50 text-xs font-mono">
                        [INSERT_SLOT]
                      </div>
                    )}
                  </div>
                  {/* Slot lijnen */}
                  <div className="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-green-500 to-transparent"></div>
                  <div className="absolute inset-x-0 bottom-0 h-px bg-gradient-to-r from-transparent via-green-500 to-transparent"></div>
                </div>
                
                {/* LED Indicatoren */}
                <div className="absolute top-4 right-4 flex gap-2">
                  <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse" style={{boxShadow: '0 0 5px #00ff00'}}></div>
                  <div className="w-2 h-2 rounded-full bg-green-500/30"></div>
                </div>
              </div>
              
              {/* Eject Knop */}
              <button
                onClick={ejectMessage}
                disabled={messages.length === 0 || ejecting}
                className="mt-4 w-full bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 disabled:from-gray-600 disabled:to-gray-500 text-black font-bold py-3 px-6 rounded border-2 border-green-400 transition-all hover:scale-105 active:scale-95 disabled:cursor-not-allowed font-mono"
                style={{boxShadow: '0 0 15px rgba(0, 255, 0, 0.5)'}}
              >
                {ejecting ? '[PROCESSING...]' : availableMessages.length === 0 ? '↻ RESET & EJECT' : '▶ EJECT MESSAGE'}
              </button>
            </div>
          </div>

          {/* Message Display - Midden in Scherm met overlay */}
          {currentMessage && (
            <div className="fixed inset-0 flex items-start justify-center z-50 overflow-y-auto custom-scrollbar p-4 pointer-events-none">
              <div className="corner-cut bg-black/95 backdrop-blur-lg border-4 border-green-500 p-8 w-full max-w-2xl my-auto relative pointer-events-auto"
                   style={{boxShadow: '0 0 30px rgba(0, 255, 0, 0.5), inset 0 0 30px rgba(0, 255, 0, 0.1)'}}>
                
                {/* Hoeken brackets */}
                <div className="absolute -top-2 -left-2 text-green-400 text-3xl font-bold">┏</div>
                <div className="absolute -top-2 -right-2 text-green-400 text-3xl font-bold">┓</div>
                <div className="absolute -bottom-2 -left-2 text-green-400 text-3xl font-bold">┗</div>
                <div className="absolute -bottom-2 -right-2 text-green-400 text-3xl font-bold">┛</div>
                
                {/* Scanline */}
                <div className="absolute inset-0 pointer-events-none overflow-hidden">
                  <div className="scanline w-full h-12 bg-gradient-to-b from-transparent via-green-500/10 to-transparent"></div>
                </div>
                
                {/* Header */}
                <div className="border-b-2 border-green-500/50 pb-3 mb-4">
                  <div className="text-green-400 text-xs font-mono mb-1">
                    ╔═══════════════════════════════════════╗
                  </div>
                  <div className="text-green-500 text-sm font-mono tracking-wider">
                    &gt;&gt; DATA RETRIEVED
                  </div>
                </div>
                
                {/* Message Inhoud */}
                <div className="bg-black/40 border border-green-500/30 p-6 rounded mb-4">
                  <p className="text-green-400 text-xl font-mono leading-relaxed mb-4">
                    {currentMessage.text}
                  </p>
                  {currentMessage.author && (
                    <p className="text-green-500/70 text-sm font-mono text-right">
                      — FROM: {currentMessage.author}
                    </p>
                  )}
                </div>
                
                {/* Footer */}
                <div className="border-t-2 border-green-500/50 pt-3">
                  <div className="text-green-400 text-xs font-mono mb-2">
                    ╚═══════════════════════════════════════╝
                  </div>
                  <button
                    onClick={closeMessage}
                    className="w-full bg-green-600 hover:bg-green-500 text-black font-bold py-2 px-4 rounded border-2 border-green-400 transition-all font-mono"
                    style={{boxShadow: '0 0 10px rgba(0, 255, 0, 0.5)'}}
                  >
                    [CLOSE] — PRESS ESC
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Fout Indicator */}
          {error && (
            <div className="fixed top-4 right-4 bg-black border-2 border-yellow-500 text-yellow-400 p-3 rounded max-w-xs text-sm font-mono"
                 style={{boxShadow: '0 0 15px rgba(255, 255, 0, 0.3)'}}>
              <p className="font-bold">⚠ FALLBACK MODE</p>
              <p className="text-xs mt-1">Using sample data</p>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<MessageDrive />, document.getElementById('root'));
  </script>
</body>
</html>
